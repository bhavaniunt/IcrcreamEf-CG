Updated source code with error fixing
